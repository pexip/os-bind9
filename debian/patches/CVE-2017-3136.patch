From 764240ca07ab1b796226d5402ccd9fbfa77ec32a Mon Sep 17 00:00:00 2001
From: Mark Andrews <marka@isc.org>
Date: Wed, 15 Feb 2017 12:18:51 +1100
Subject: [PATCH] 4575.   [security]      Dns64 with break-dnssec yes; can
 result in a                         assertion failure. (CVE-2017-3136) [RT
 #44653]

(cherry picked from commit 3bce12e4b6d37f570ffc7747b499f8b90e8521ac)
---
--- a/bin/named/query.c
+++ b/bin/named/query.c
@@ -8145,6 +8145,7 @@ query_find(ns_client_t *client, dns_fetc
 			result = query_dns64(client, &fname, rdataset,
 					     sigrdataset, dbuf,
 					     DNS_SECTION_ANSWER);
+			noqname = NULL;
 			dns_rdataset_disassociate(rdataset);
 			dns_message_puttemprdataset(client->message, &rdataset);
 			if (result == ISC_R_NOMORE) {
